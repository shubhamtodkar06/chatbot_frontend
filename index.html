<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

        /* Styling (as provided before) ... */
    </style>
</head>
<body>

    <div class="chat-container">
        <div class="chat-header">Chatbot</div>
        <div id="chatbox"><div></div></div>
        <div class="chat-input">
            <input type="text" id="userInput" placeholder="Type a message..." onkeypress="handleKeyPress(event)">
            <button class="send-btn" onclick="sendMessageFromButton()">Send</button>
        </div>
    </div>

    <script>
        var chatbox = document.getElementById('chatbox');
        var chatboxContent = chatbox.querySelector('div');
        var userInput = document.getElementById('userInput');

        const backendUrl = process.env.RENDER_BACKEND_URL || '';
        var socket = io(backendUrl);

        socket.on('connect', function() {
            console.log('Connected to server');
        });

        socket.on('disconnect', function() {
            console.log('Disconnected from server');
        });

        socket.on('message', function(data) {
            var message = document.createElement('p');
            message.textContent = data;
            message.classList.add('bot-message');
            chatboxContent.appendChild(message);
            chatbox.scrollTop = chatbox.scrollHeight;
        });

        function sendMessage(message) {
            if (message.trim() === '') return;
            socket.emit('user_message', message);
            var userMessage = document.createElement('p');
            userMessage.textContent = 'You: ' + message;
            userMessage.classList.add('user-message');
            chatboxContent.appendChild(userMessage);
            userInput.value = "";
            chatbox.scrollTop = chatbox.scrollHeight;
        }

        function handleKeyPress(event) {
            if (event.key === "Enter") {
                sendMessage(userInput.value);
            }
        }

        function sendMessageFromButton() {
            sendMessage(userInput.value);
        }
    </script>

</body>
</html>